# Introduction to NLP Pipelines

In this chapter, we will introduce the topic of processing with neural architectures language in general. This includes natural language, code etc. 

Python and almost all programming languages are formal. They define a strict set of rules called a _grammar_ that the programmer must follow religiously. In addition formal languages also define semantics or meaning of the program via a set of rules. So the exit code `0` after the execution of a routine has the meaning of successful termination but a `1` the opposite. 

The English language on the other hand is "free wheeling" so to speak due to its ambiguity and size. 

Some examples are in order:

* **Ambiguity**: "he met his maker"

* **Same context, different meaning**: 
    1. "The food in this restaurant was good, not bad at all"
    2. "The food in this restaurant was bad, not good at all."

* **Different context alltogether**: 

    1. "The bank's profits eroded soon after the 2008 crisis"
    2. "The river's bank eroded after the 2008 floods"


To capture the fuzziness of language we need to define probabilistic models. In other words we will be speaking of _a probability distribution over possible meanings_ of the input text.  


## NLP Pipelines

This paragraph is heavily borrowed from [here](https://medium.com/@ageitgey/natural-language-processing-is-fun-9a0bff37854e).

| Term                               | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ---------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Segmentation**                   | The first step in the pipeline is to break the text apart into separate sentences. Coding a Sentence Segmentation model can be as simple as splitting apart sentences whenever you see a punctuation mark. But modern NLP pipelines often use more complex techniques that work even when a document isn’t formatted cleanly. Take for example the sentence “London is the capital and most populous city of England and the United Kingdom.”                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **Tokenization**              | The next step in our pipeline is to break this sentence into separate words or tokens. This is called tokenization. “London”, “is”, “ the”, “capital”, “and”, “most”, “populous”, “city”, “of”, “England”, “and”, “the”, “United”, “Kingdom”, “.”                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Part of Speech Tagging**         | The next step tags each word with a classification result of its part - whether it is a noun, a verb, an adjective and so on. We can do this by feeding each word (and some extra words around it for context) into a pre-trained part-of-speech classification model:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                                    | ![pos-classification](images/pos-classification.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|                                    | ![pos-example](images/pos-example.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Lematization**                   | This is one of the stages of _vocabulary normalization_.  At this stage we are figuring out the most basic form or lemma of each word in the sentence.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                                    | ![lemmatization](images/lemmatization.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **Stop words identification**      | This is one of the stages of _vocabulary normalization_.  Stop words are common words in any language that occur with a high frequency but carry much less substantive information about the meaning of a phrase.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                                    | ![stop-words](images/stop-words.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Dependency Parsing**             | The next step is to figure out how all the words in our sentence relate to each other. This is called dependency parsing. The goal is to build a tree that assigns a single parent word to each word in the sentence. The root of the tree will be the main verb in the sentence. In addition to identifying the parent word of each word, we can also predict the type of relationship that exists between those parent and child. This parse tree shows us that the subject of the sentence is the noun “London” and it has a “be” relationship with “capital”. We finally know something useful — London is a capital. Dependency parsing in NLP stacks circa 2017 was heavily based on [deep learning](https://ai.googleblog.com/2017/03/an-upgrade-to-syntaxnet-new-models-and.html) architectures - [demo](https://explosion.ai/demos/displacy?text=the%20students%20of%20CS-GY-6613%20are%20having%20a%20difficult%20time%20with%20professor%20Pantelis&model=en_core_web_sm&cpu=1&cph=1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                                    | ![dependency-parsing](images/dependency-parsing.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Named Entity Recognition (NER)** | The goal of Named Entity Recognition, or NER, is to detect and label nouns with the real-world concepts that they represent. NER systems aren’t just doing a simple dictionary lookup. Instead, they are using the context of how a word appears in the sentence and a statistical model to guess which type of noun a word represents. [demo](https://explosion.ai/demos/displacy-ent?text=A%20rapid%20increase%20in%20virtual%20visits%20during%20the%202019%20coronavirus%20disease%20(COVID-19)%20pandemic%20could%20transform%20the%20way%20physicians%20provide%20care%20in%20the%20United%20States%20going%20forward%2C%20according%20to%20a%20new%20study%20led%20by%20researchers%20from%20NYU%20Grossman%20School%20of%20Medicine.%0A%0A%E2%80%9CThe%20pandemic%20created%20an%20urgent%20need%20to%20divert%20patients%20from%20inpatient%20care%20and%20prevent%20the%20flooding%20of%20our%20emergency%20rooms%20beyond%20capacity%2C%E2%80%9D%20says%20Devin%20Mann%2C%20MD%2C%20associate%20professor%20in%20the%20Departments%20of%20Population%20Health%20and%20Medicine%2C%20senior%20director%20for%20informatics%20innovation%20and%20the%20information%20technology%20team%20at%20NYU%20Langone%2C%20and%20the%20study%E2%80%99s%20lead%20author.%20%E2%80%9CThrough%20telemedicine%2C%20we%20pushed%20the%20front%20lines%20to%20locations%20far%20from%20our%20hospitals%20and%20doctor%E2%80%99s%20offices.%20And%20because%20NYU%20%0ALangone%20invested%20early%20in%20this%20technology%2C%20we%20quickly%20leveraged%20it%20to%20help%20hundreds%20of%20thousands%20of%20patients.%E2%80%9D&model=en_core_web_sm&ents=person%2Corg%2Cgpe%2Cloc%2Cproduct%2Cnorp%2Cdate%2Cper%2Cmisc) |
| **Coreference Resolution**         | Coreference resolution is the task of finding all expressions that refer to the same entity in a text. It is an important step for a lot of higher level NLP tasks that involve natural language understanding such as document summarization, question answering, and information extraction. Coreference resolution is one of the most difficult steps in our pipeline to [implement](https://huggingface.co/coref/)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                                    | ![coreference-resolution](images/coreference-resolution.png) |




